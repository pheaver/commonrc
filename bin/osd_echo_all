#!/bin/bash

osd_echo "$@" 1>/dev/null 2>&1 &

if [ $UID -eq 0 ]; then
    su pweaver -c "$0" "$@"

else # TODO: refuse to execute for anybody but pweaver

    [ -f ~/.agent ] && . ~/.agent

    if [ "$HOSTNAME" != "silver" ]; then
	ssh silver title=$HOSTNAME osd_echo "$@" 1>/dev/null 2>&1 &
    fi
    
    if [ "$HOSTNAME" != "tux" ]; then
	ssh tux title=$HOSTNAME osd_echo "$@" 1>/dev/null 2>&1 &
    fi
    
    if [ "$HOSTNAME" != "white" ]; then
	ssh white title=$HOSTNAME osd_echo "$@" 1>/dev/null 2>&1 ||
	ssh white2 title=$HOSTNAME osd_echo "$@" 1>/dev/null 2>&1 &
    fi
    
    if [ "$HOSTNAME" != "macbook" ]; then
	ssh macbook title=$HOSTNAME osd_echo "$@" 1>/dev/null 2>&1 &
    fi

fi
